// Generated by uRequire v0.7.0-beta9  template: 'combined'
// Combined template optimized with RequireJS/r.js v2.1.15 & almond v0.3.0.
/**
 * @license almond 0.3.0 Copyright (c) 2011-2014, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/jrburke/almond for details
 */

(function(e,t){var r=!("function"!=typeof define||!define.amd),n="object"==typeof exports,i=function(){var e,r,n;!function(t){function i(e,t){return q.call(e,t)}function o(e,t){var r,n,i,o,u,a,s,c,f,l,d,p=t&&t.split("/"),v=y.map,h=v&&v["*"]||{};if(e&&"."===e.charAt(0))if(t){for(p=p.slice(0,p.length-1),e=e.split("/"),u=e.length-1,y.nodeIdCompat&&x.test(e[u])&&(e[u]=e[u].replace(x,"")),e=p.concat(e),f=0;f<e.length;f+=1)if(d=e[f],"."===d)e.splice(f,1),f-=1;else if(".."===d){if(1===f&&(".."===e[2]||".."===e[0]))break;f>0&&(e.splice(f-1,2),f-=2)}e=e.join("/")}else 0===e.indexOf("./")&&(e=e.substring(2));if((p||h)&&v){for(r=e.split("/"),f=r.length;f>0;f-=1){if(n=r.slice(0,f).join("/"),p)for(l=p.length;l>0;l-=1)if(i=v[p.slice(0,l).join("/")],i&&(i=i[n])){o=i,a=f;break}if(o)break;!s&&h&&h[n]&&(s=h[n],c=f)}!o&&s&&(o=s,a=c),o&&(r.splice(0,a,o),e=r.join("/"))}return e}function u(e,r){return function(){var n=b.call(arguments,0);return"string"!=typeof n[0]&&1===n.length&&n.push(null),p.apply(t,n.concat([e,r]))}}function a(e){return function(t){return o(t,e)}}function s(e){return function(t){m[e]=t}}function c(e){if(i(g,e)){var r=g[e];delete g[e],j[e]=!0,d.apply(t,r)}if(!i(m,e)&&!i(j,e))throw new Error("No "+e);return m[e]}function f(e){var t,r=e?e.indexOf("!"):-1;return r>-1&&(t=e.substring(0,r),e=e.substring(r+1,e.length)),[t,e]}function l(e){return function(){return y&&y.config&&y.config[e]||{}}}var d,p,v,h,m={},g={},y={},j={},q=Object.prototype.hasOwnProperty,b=[].slice,x=/\.js$/;v=function(e,t){var r,n=f(e),i=n[0];return e=n[1],i&&(i=o(i,t),r=c(i)),i?e=r&&r.normalize?r.normalize(e,a(t)):o(e,t):(e=o(e,t),n=f(e),i=n[0],e=n[1],i&&(r=c(i))),{f:i?i+"!"+e:e,n:e,pr:i,p:r}},h={require:function(e){return u(e)},exports:function(e){var t=m[e];return"undefined"!=typeof t?t:m[e]={}},module:function(e){return{id:e,uri:"",exports:m[e],config:l(e)}}},d=function(e,r,n,o){var a,f,l,d,p,y,q=[],b=typeof n;if(o=o||e,"undefined"===b||"function"===b){for(r=!r.length&&n.length?["require","exports","module"]:r,p=0;p<r.length;p+=1)if(d=v(r[p],o),f=d.f,"require"===f)q[p]=h.require(e);else if("exports"===f)q[p]=h.exports(e),y=!0;else if("module"===f)a=q[p]=h.module(e);else if(i(m,f)||i(g,f)||i(j,f))q[p]=c(f);else{if(!d.p)throw new Error(e+" missing "+f);d.p.load(d.n,u(o,!0),s(f),{}),q[p]=m[f]}l=n?n.apply(m[e],q):void 0,e&&(a&&a.exports!==t&&a.exports!==m[e]?m[e]=a.exports:l===t&&y||(m[e]=l))}else e&&(m[e]=n)},e=r=p=function(e,r,n,i,o){if("string"==typeof e)return h[e]?h[e](r):c(v(e,r).f);if(!e.splice){if(y=e,y.deps&&p(y.deps,y.callback),!r)return;r.splice?(e=r,r=n,n=null):e=t}return r=r||function(){},"function"==typeof n&&(n=i,i=o),i?d(t,e,r,n):setTimeout(function(){d(t,e,r,n)},4),p},p.config=function(e){return p(e)},e._defined=m,n=function(e,t,r){t.splice||(r=t,t=[]),i(m,e)||i(g,e)||(g[e]=[e,t,r])},n.amd={jQuery:!0}}(),n("almond",function(){}),n("jsonrpc",["require","exports","module"],function(e,r,n){"use strict";var i=t.jet=t.jet||{};return i.JsonRPC=function(e){var r,n=JSON.stringify,o=JSON.parse,u=t.WebSocket||t.MozWebSocket,a=e.url||"ws://127.0.0.1:11123",s=new u(a,"jet"),c=[],f=i.util.isDef,l=i.util.isArr,d=i.util.errorObject,p=this;this.queue=function(e){c.push(e)};var v=!0;this.flush=function(){var t;1===c.length?t=n(c[0]):c.length>1&&(t=n(c)),t&&(e.onSend&&e.onSend(t,c),s.send(t),c.length=0),v=!1};var h={},m={};this.addRequestDispatcher=function(e,t){h[e]=t},this.removeRequestDispatcher=function(e){delete h[e]},this.hasRequestDispatcher=function(e){return f(h[e])};var g=function(e){var t=e.id,r=m[t];delete m[t],r&&(f(e.result)?r.success&&r.success(e.result):f(e.error)&&r.error&&r.error(e.error))},y=function(e){var t=h[e.method];try{t(e)}catch(r){f(e.id)&&p.queue({id:e.id,error:d(r)})}},j=function(e){e.method&&e.params?y(e):(f(e.result)||f(e.error))&&g(e)},q=function(t){var r=o(t.data);v=!0,e.onReceive&&e.onReceive(t.data,r),l(r)?r.forEach(function(e){j(e)}):j(r),p.flush()};s.onmessage=q;var b=function(e,t,r){if(e[t]){var n=e[t];e[t]=function(e){r(),n(e)}}else e[t]=r},x=0;return this.service=function(e,t,i,o){var u;if(r)throw new Error("Jet Websocket connection is closed");o?(t.timeout=o.timeout,x+=1,u=x,i&&(b(o,"success",function(){i(!0)}),b(o,"error",function(){i(!1)})),m[x]=o):i&&i(!0);var a={id:u,method:e,params:t};v?p.queue(a):s.send(n(a))},this.batch=function(e){v=!0,e(),p.flush()},this.close=function(){r=!0,p.flush(),s.close()},s.onclose=function(){r=!0,e.onClose&&e.onClose()},s.onerror=function(t){r=!0,e.onError&&e.onError(t)},p.config=function(e,t){p.service("config",e,null,t)},s.onopen=function(){f(e.name)?p.config({name:e.name},{success:function(){p.flush(),e.onOpen&&e.onOpen()},error:function(){p.close()}}):e.onOpen&&e.onOpen(p),p.flush()},this},n.exports}),n("peer",["require","exports","module"],function(e,r,n){"use strict";var i=t.jet=t.jet||{};return i.Peer=function(e){e=e||{};var t=i.util.isDef,r=i.util.isArr,n=i.util.invalidParams,o=i.util.errorObject,u=new i.JsonRPC(e),a=this;a.close=function(){u.close()},a.batch=function(e){u.batch(e)},a.add=function(e,r,n){var i=e.path,o=function(e){e&&u.addRequestDispatcher(i,r)},s={path:i,value:e.value};u.service("add",s,o,n);var c={remove:function(e){a.remove(i,e)},isAdded:function(){return u.hasRequestDispatcher(i)},add:function(n,i){t(n)&&(e.value=n),a.add(e,r,i)},path:function(){return i}};return c},a.remove=function(e,t){var r={path:e},n=function(){u.removeRequestDispatcher(e)};u.service("remove",r,n,t)},a.call=function(e,t,r){var n={path:e,args:t||[],timeout:r&&r.timeout};u.service("call",n,null,r)},a.set=function(e,t,r){var n={path:e,value:t,valueAsResult:r&&r.valueAsResult,timeout:r&&r.timeout};u.service("set",n,null,r)};var s=0;return a.fetch=function(e,r,n){var i="__f__"+s,o=e.sort;s+=1;var a,c=function(){u.addRequestDispatcher(i,function(e){var n=e.params;t(o)?r(n.changes,n.n,a):r(n.path,n.event,n.value,a)})};return"string"==typeof e&&(e={path:{contains:e}}),e.id=i,u.service("fetch",e,c,n),a={unfetch:function(e){var t=function(){u.removeRequestDispatcher(i)};u.service("unfetch",{id:i},t,e)},isFetching:function(){return u.hasRequestDispatcher(i)},fetch:function(t){u.service("fetch",e,c,t)}}},a.method=function(e,n){var i;if(e.call)i=function(n){var i,a,s=n.params;try{i=r(s)&&s.length>0?e.call.apply(void 0,s):e.call.call(void 0,s)}catch(c){a=c}var f=n.id;t(f)&&u.queue(t(a)?{id:f,error:o(a)}:{id:f,result:i||{}})};else{if(!e.callAsync)throw"invalid method desc"+(e.path||"?");i=function(n){var i=function(r){var i=n.id;if(r=r||{},t(i)){var a={id:i};t(r.result)&&!t(r.error)?a.result=r.result:a.error=o(t(r.error)?r.error:"jet.peer Invalid async method response "+e.path),u.queue(a),u.flush()}},a=n.params;try{r(a)&&a.length>0?(a.push(i),e.callAsync.apply(void 0,a)):e.callAsync.call(void 0,a,i)}catch(s){var c=n.id;t(c)&&u.queue({id:c,error:o(s)})}}}var s=a.add(e,i,n);return s},a.state=function(e,r){var i;i=e.set?function(r){var n=r.params.value;try{var i=e.set(n)||{};e.value=i.value||n;var a=r.id;t(a)&&u.queue({id:a,result:!0}),i.dontNotify||u.queue({method:"change",params:{path:e.path,value:e.value}})}catch(s){t(r.id)&&u.queue({id:r.id,error:o(s)})}}:t(e.setAsync)?function(r){var n=r.params.value,i=function(i){var a=r.id;if(i=i||{},i.result=t(i.result)||n,t(a)){var s={id:a};t(i.error)?s.error=o(i.error):s.result=i.result,u.queue(s)}t(i.result)&&!t(i.dontNotify)&&(e.value=t(i.value)?i.value:n,u.queue({method:"change",params:{path:e.path,value:e.value}})),u.flush(i.dontNotify)};try{e.setAsync(n,i)}catch(a){var s=r.id;t(s)&&u.queue({id:s,error:o(a)})}}:function(r){var i=r.id;t(i)&&u.queue({id:i,error:n(e.path+" is read-only")})};var s=a.add(e,i,r);return s.value=function(r){return t(r)?(e.value=r,u.queue({method:"change",params:{path:e.path,value:r}}),u.flush(),void 0):e.value},s},a},n.exports}),n("util",["require","exports","module"],function(e,r,n){"use-strict";var i=t.jet=t.jet||{};return i.util={},t.jet.util.invalidParams=function(e){var t={code:-32602,message:"Invalid params",data:e};return t},t.jet.util.errorObject=function(e){var r,n=t.jet.util.isDef;return"object"==typeof e&&n(e.code)&&n(e.message)?e:("object"==typeof e&&(r={},r.message=e.message,r.lineNumber=e.lineNumber,r.fileName=e.fileName),{code:-32602,message:"Internal error",data:r||e})},t.jet.util.isDef=function(e){return"undefined"!=typeof e},t.jet.util.isArr=function(e){return e instanceof Array},n.exports}),r("jsonrpc"),r("peer"),r("util")};return r?define(i):n?module.exports=i():i()}).call(this,"object"==typeof exports||"undefined"==typeof window?global:window,"object"==typeof exports||"undefined"==typeof window?global:window);